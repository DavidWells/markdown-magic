# Build and release md-magic binaries to GitHub Releases
name: Release Binary (md-magic)

on:
  release:
    types: [created]
  workflow_dispatch:
    inputs:
      version:
        description: 'Version tag (e.g., markdown-magic@4.0.5)'
        required: true
        type: string

jobs:
  release:
    if: github.event_name == 'workflow_dispatch' || startsWith(github.event.release.tag_name, 'markdown-magic@')
    uses: ./.github/workflows/build-binary.yml
    with:
      package_path: packages/core
      binary_name: md-magic
      tag_prefix: 'markdown-magic@'
      version_tag: ${{ inputs.version || github.event.release.tag_name }}
    permissions:
      contents: write
